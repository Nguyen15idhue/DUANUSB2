<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="USB Dongle Sync Service" 
           Manufacturer="CHC Geomatics" 
           Version="1.0.0.0" 
           UpgradeCode="B5F8E7D4-3C2A-4F1B-9E8D-7A6B5C4D3E2F">
    
    <MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />
    
    <!-- Installation directory structure -->
    <StandardDirectory Id="ProgramFiles6432Folder">
      <Directory Id="CompanyFolder" Name="CHC Geomatics">
        <Directory Id="INSTALLFOLDER" Name="Dongle Service" />
      </Directory>
    </StandardDirectory>
    
    <!-- Service executable and files -->
    <ComponentGroup Id="ServiceFiles" Directory="INSTALLFOLDER">
      <Component>
        <File Source="$(var.SourceDir)\DongleSyncService.exe" />
        
        <ServiceInstall Id="ServiceInstaller"
                       Name="DongleSyncService"
                       DisplayName="USB Dongle Sync Service"
                       Description="Manages USB dongle for CHC Geomatics Office licensing"
                       Type="ownProcess"
                       Start="auto"
                       Account="LocalSystem"
                       ErrorControl="normal" />
        
        <ServiceControl Id="ServiceControl"
                       Name="DongleSyncService"
                       Start="install"
                       Stop="both"
                       Remove="uninstall" />
      </Component>
      
      <!-- All DLL files -->
      <Component>
        <File Source="$(var.SourceDir)\*.dll" />
      </Component>
    </ComponentGroup>
    
    <Feature Id="MainFeature">
      <ComponentGroupRef Id="ServiceFiles" />
    </Feature>
  </Package>
</Wix>
